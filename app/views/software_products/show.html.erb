<%= render :partial => 'commons/breadcrumbs' %>
<div class="software-product-attribute">
  <p class="pull-left">Название программного продукта:</p>
  <p class="pull-left"><%= @software_product.title %></p>
  <div class="btn-group pull-right" role="group">
    <%= link_to edit_software_product_path(@software_product), :class =>"btn btn-warning", :title => "Редактировать" do %>
      <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
    <% end %>
    <%= link_to software_product_path(@software_product), :class =>"btn btn-danger", :method => :delete, :title => "Удалить", :data => {:confirm => "Вы уверены?"} do %>
      <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
    <% end %>
  </div>
</div>

<div class="software-product-attribute">
  <div class="panel panel-primary">
    <div class="panel-heading">Объекты исследования:</div>
    <div class="panel-body js-panel-body">
      <% if params[:job_id].present? %>
        <div class="js-progress">
          <p><%= I18n.t("progressbar.title.#{params[:pb_kind]}") %></p>
          <div class="progress">
            <div class="js-progressbar progress-bar progress-bar-striped active" role="progressbar" aria-valuemin="0" aria-valuemax="100" style="width: 0%;" data-jobid=<%= params[:job_id] %>></div>
          </div>
        </div>
      <% end %>
      <%= render :partial => 'csv_info' %>
    </div>
  </div>
</div>

<div class="software-product-attribute">
  <div class="panel panel-primary">
    <div class="panel-heading">Группировки:</div>
    <div class="panel-body">
      <%= link_to new_software_product_grouping_path(@software_product), :class=> "btn btn-success pull-right" do %>
        <span class="glyphicon glyphicon-plus" aria-hidden="true"></span>
        Добавить группировку
      <% end %>
      <div class="groupings">
        <% if @software_product.groupings.present?  %>
          <% @software_product.groupings.each do |grouping| %>
            <p>
              <%= grouping.title %>
              <%= link_to edit_software_product_grouping_path(@software_product, grouping), :title => "Редактировать группировку" do %>
                <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
              <% end %>
              <%= link_to  software_product_grouping_path(@software_product, grouping), :title => "Удалить группировку", :method => :delete, :data => {:confirm => "Вы уверены?"} do %>
                <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
              <% end %>
            </p>
            <% if grouping.grouping_parameters.present? %>
              <p>Параметры группировки:</p>
              <ul>
                <% grouping.grouping_parameters.each do |parameter| %>
                  <li>
                    <%= parameter.grouping_field %>(<%= I18n.t("enumerize.kind.#{parameter.kind}") %>)
                    <%= link_to edit_software_product_grouping_grouping_parameter_path(@software_product, grouping, parameter), :title => "Редактировать параметр группировки" do %>
                      <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
                    <% end %>
                    <%= link_to software_product_grouping_grouping_parameter_path(@software_product, grouping, parameter), :title => "Удалить параметр группировки", :method => :delete, :data => {:confirm => "Вы уверены?"} do %>
                      <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
                    <% end %>
                    <%= render :partial => "#{parameter.kind}_values", :locals => { :values => parameter.grouping_values } %>
                  </li>
                <% end %>
              </ul>
            <% end %>
            <%= link_to "Сегменты", software_product_grouping_segments_path(@software_product, grouping), :class => "btn btn-default" %>
          <% end %>
        <% else %>
          <h4>Не добавлено ни одной группировки</h4>
        <% end %>
      </div>
    </div>
  </div>
</div>

<div class="software-product-attribute">
  <p class="pull-left">
    Модели:
    <%= link_to  new_software_product_replication_model_path(@software_product), :title => "Добавить модель" do %>
      <span class="glyphicon glyphicon-plus" aria-hidden="true"></span>
    <% end %>
  </p>
  <div class="models">
    <% if @software_product.replication_models.present? %>
      <% @software_product.replication_models.each do |model| %>
        <div class="panel panel-default">
          <div class="panel-body">
            <%= model.title %>
            <%= link_to edit_software_product_replication_model_path(@software_product, model), :title => "Редактировать модель" do %>
              <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
            <% end %>
            <%= link_to software_product_replication_model_path(@software_product, model), :title => "Удалить модель", :method => :delete, :data => {:confirm => "Вы уверены?"} do %>
              <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
            <% end %>
            <p>Трудовые ресурсы:</p>
            <ul>
              <% model.workforces.each do |workforce| %>
                <li><%= workforce.specialists %></li>
              <% end %>
            </ul>
          </div>
        </div>
      <% end %>
    <% else %>
      <h4>Не добавлено ни одной модели</h4>
    <% end %>
  </div>
</div>
